function _bindShadowClick(){_createShadow().onclick=function(e){if(e.target===this){var n=this,t=n.querySelector(".modal-content"),o=n.parentElement;_dismissModal(o,n,t)}}}function _addOpenAnimationToModal(){var e,n=document.querySelectorAll(".modal-wrap");for(e=n.length-1;e>=0;e--)!function(e){n[e].classList.add("openAnimation")}(e)}function _addCloseAnimationBeforeDismiss(){_dismissModal=function(e){return function(n,t,o){var i=arguments,a=t.onclick||null,d=function(o){e.apply(this,i),document.body.removeEventListener("animationend",d),n.classList.remove("closeAnimation"),t.onclick=a};t.onclick=null,n.classList.add("closeAnimation"),document.body.addEventListener("animationend",d)}}(_dismissModal)}function _openModal(e,n,t){e.removeChild(t),n.appendChild(t),e.appendChild(n),e.classList.add("modal-show")}function _dismissModal(e,n,t){n.removeChild(t),e.removeChild(n),e.appendChild(t),e.classList.remove("modal-show")}function _addCrossToHeader(){var e,n=document.createElement("link"),t=document.querySelectorAll(".modal-header");for(n.rel="stylesheet",n.href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css",document.head.appendChild(n),e=t.length-1;e>=0;e--)!function(e){var n=document.createElement("i");n.classList.add("fa","fa-times","modal-header-cross"),t[e].appendChild(n)}(e);return document.querySelectorAll(".modal-header-cross")}function _bindOpenHandler(e){for(var n=e.length-1;n>=0;n--)e[n].onclick=function(){var e=this.getAttribute("data-target"),n=document.querySelector("#"+e),t=_createShadow(),o=n.querySelector(".modal-content");_openModal(n,t,o),t.offsetHeight<o.offsetHeight-40?t.classList.add("block"):t.classList.remove("block"),this.blur(),o.focus()}}function _getModalFromInside(e){return e&&e.classList.contains("modal-wrap")?e:_getModalFromInside(e.parentElement)}function _bindCancelHandler(e){for(var n=e.length-1;n>=0;n--)e[n].onclick=function(){var e=_getModalFromInside(this),n=e.querySelector(".modal-shadow"),t=n.querySelector(".modal-content");_dismissModal(e,n,t)}}function _bindEscHandler(){var e,n=document.querySelectorAll(".modal-content");for(e=n.length-1;e>=0;e--)n[e].setAttribute("tabIndex","1"),n[e].onkeydown=function(e){var n=this,t=this.parentElement,o=_getModalFromInside(this),i=e.charCode||e.keyCode;27===i&&_dismissModal(o,t,n)}}function _before(e,n){return function(){return n.apply(this,arguments),e.apply(this,arguments)}}function _after(e,n){return function(){var t=e.apply(this,arguments);return n.apply(this,arguments),t}}var Modal=function(e){this.buttons=document.querySelectorAll("[data-toggle=modal]"),this.cancels=document.querySelectorAll("[data-dismiss=modal]"),this.conf=e};Modal.prototype.init=function(){var e=this.buttons,n=this.cancels,t=this.conf;if(t&&t.close){var o=_addCrossToHeader();_bindCancelHandler(o)}t&&t.animation&&(_addOpenAnimationToModal(),_addCloseAnimationBeforeDismiss()),t&&t.shadowClose&&_bindShadowClick(),_bindEscHandler(),_bindCancelHandler(n),_bindOpenHandler(e)};var _createShadow=function(){var e=null,n=function(){return e=document.createElement("div"),e.classList.add("modal-shadow"),t(),e},t=function(){var n;window.onresize=function(){clearTimeout(n),n=setTimeout(function(){e.style.height=window.innerHeight+"px",e.style.width=window.innerWidth+"px"},20)}};return function(){return e=e||n(),e.style.height=window.innerHeight+"px",e.style.width=window.innerWidth+"px",e}}();