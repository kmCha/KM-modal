function _bindShadowClick(){_createShadow().onclick=function(e){if(e.target===this){var t=this,n=t.querySelector(".modal-content"),o=t.parentElement;_dismissModal(o,t,n)}}}function _addAnimationToContent(){var e,t=document.querySelectorAll(".modal-content");for(e=t.length-1;e>=0;e--)!function(e){t[e].classList.add("animation")}(e)}function _openModal(e,t,n){e.removeChild(n),t.appendChild(n),e.appendChild(t),e.classList.add("modal-show")}function _dismissModal(e,t,n){t.removeChild(n),e.removeChild(t),e.appendChild(n),e.classList.remove("modal-show")}function _addCrossToHeader(){var e,t=document.createElement("link"),n=document.querySelectorAll(".modal-header");for(t.rel="stylesheet",t.href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css",document.head.appendChild(t),e=n.length-1;e>=0;e--)!function(e){var t=document.createElement("i");t.classList.add("fa","fa-times","modal-header-cross"),n[e].appendChild(t)}(e);return document.querySelectorAll(".modal-header-cross")}function _bindOpenHandler(e){for(var t=e.length-1;t>=0;t--)e[t].onclick=function(){var e=this.getAttribute("data-target"),t=document.querySelector("#"+e),n=_createShadow(),o=t.querySelector(".modal-content");_openModal(t,n,o),n.offsetHeight<o.offsetHeight-40?n.classList.add("block"):n.classList.remove("block"),this.blur(),o.focus()}}function _getModalFromInside(e){return e&&e.classList.contains("modal-wrap")?e:_getModalFromInside(e.parentElement)}function _bindCancelHandler(e){for(var t=e.length-1;t>=0;t--)e[t].onclick=function(){var e=_getModalFromInside(this),t=e.querySelector(".modal-shadow"),n=t.querySelector(".modal-content");_dismissModal(e,t,n)}}function _bindEscHandler(){var e,t=document.querySelectorAll(".modal-content");for(e=t.length-1;e>=0;e--)t[e].setAttribute("tabIndex","1"),t[e].onkeydown=function(e){var t=this,n=this.parentElement,o=_getModalFromInside(this),d=e.charCode||e.keyCode;27===d&&_dismissModal(o,n,t)}}var Modal=function(e){this.buttons=document.querySelectorAll("[data-toggle=modal]"),this.cancels=document.querySelectorAll("[data-dismiss=modal]"),this.conf=e};Modal.prototype.init=function(){var e=this.buttons,t=this.cancels,n=this.conf;if(n&&n.close){var o=_addCrossToHeader();_bindCancelHandler(o)}n&&n.animation&&_addAnimationToContent(),n&&n.shadowClose&&_bindShadowClick(),_bindEscHandler(),_bindCancelHandler(t),_bindOpenHandler(e)};var _createShadow=function(){var e=null,t=function(){return e=document.createElement("div"),e.classList.add("modal-shadow"),n(),e},n=function(){var t;window.onresize=function(){clearTimeout(t),t=setTimeout(function(){e.style.height=window.innerHeight+"px",e.style.width=window.innerWidth+"px"},20)}};return function(){return e=e||t(),e.style.height=window.innerHeight+"px",e.style.width=window.innerWidth+"px",e}}();