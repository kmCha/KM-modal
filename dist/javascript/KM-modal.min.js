var Modal=function(){function t(){var t,n=f.length;for(t=n-1;t>=0;t--)f[t]._status="close"}function n(t,n){for(var e in t)n&&e in n&&!n[e]||t[e]()}function e(){h().onclick=function(t){if(t.target===this){var n=this,e=n.querySelector(".modal-content"),o=n.parentElement;r(o,n,e)}}}function o(){var t,n=f.length;for(t=n-1;t>=0;t--)!function(t){modals[t].classList.add("openAnimation")}(t)}function i(){r=function(t){return function(n,e,o){var i=arguments,c=e.onclick||null,r=function(o){t.apply(this,i),document.body.removeEventListener("animationend",r),n.classList.remove("closeAnimation"),e.onclick=c};e.onclick=null,n.classList.add("closeAnimation"),document.body.addEventListener("animationend",r)}}(r)}function c(t,n,e){return"open"===t._status?console.log(t.id+"已经打开"):(t.removeChild(e),n.appendChild(e),t.appendChild(n),t.classList.add("modal-show"),void(t._status="open"))}function r(t,n,e){return"close"===t._status?console.log(t.id+"已经关闭"):(n.removeChild(e),t.removeChild(n),t.appendChild(e),t.classList.remove("modal-show"),void(t._status="close"))}function l(){var t,n=document.createElement("link"),e=document.querySelectorAll(".modal-header");for(n.rel="stylesheet",n.href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css",document.head.appendChild(n),t=e.length-1;t>=0;t--)!function(t){var n=document.createElement("i");n.classList.add("fa","fa-times","modal-header-cross"),e[t].appendChild(n)}(t);return document.querySelectorAll(".modal-header-cross")}function a(t){for(var n=t.length-1;n>=0;n--)t[n].onclick=function(){var t=this.getAttribute("data-target"),n=document.querySelector("#"+t),e=h(),o=n.querySelector(".modal-content");c(n,e,o),e.offsetHeight<o.offsetHeight-40?e.classList.add("block"):e.classList.remove("block"),this.blur(),o.focus()}}function s(t){return t&&t.classList.contains("modal-wrap")?t:s(t.parentElement)}function d(t){for(var n=t.length-1;n>=0;n--)t[n].onclick=function(){var t=s(this),n=t.querySelector(".modal-shadow"),e=n.querySelector(".modal-content");r(t,n,e)}}function u(){var t,n=document.querySelectorAll(".modal-content");for(t=n.length-1;t>=0;t--)n[t].setAttribute("tabIndex","1"),n[t].onkeydown=function(t){var n=this,e=this.parentElement,o=s(this),i=t.charCode||t.keyCode;27===i&&r(o,e,n)}}var m=function(t){this.buttons=document.querySelectorAll("[data-toggle=modal]"),this.cancels=document.querySelectorAll("[data-dismiss=modal]"),this.conf=t,this.options={close:function(){var t=l();d(t)},animation:function(){o(),i()},shadowClose:function(){e()}}},f=document.querySelectorAll(".modal-wrap");m.prototype.init=function(){var e=0;return function(){var o=this,i=function(){var i=o.buttons,c=o.cancels,r=o.conf,l=o.options;n(l,r),u(),d(c),a(i),t(),e++},c=function(){console.log("init函数只能执行一次，不然会出错")};return 0===e?i():c()}}(),m.prototype.open=function(t){var n,e=h(),o=document.getElementById(t),i=o.querySelector(".modal-content"),r=f.length;for(n=r-1;n>=0;n--)if("open"===f[n]._status)return console.log("同时只能打开一个模态框");c(o,e,i)};var h=function(){var t=null,n=function(){return t=document.createElement("div"),t.classList.add("modal-shadow"),e(),t},e=function(){var n;window.onresize=function(){clearTimeout(n),n=setTimeout(function(){t.style.height=window.innerHeight+"px",t.style.width=window.innerWidth+"px"},20)}};return function(){return t=t||n(),t.style.height=window.innerHeight+"px",t.style.width=window.innerWidth+"px",t}}();return m}();